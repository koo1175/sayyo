{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\Sayo_\\\\sayyo\\\\src\\\\views\\\\Chat\\\\index.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport { Client } from '@stomp/stompjs';\nimport SockJS from 'sockjs-client';\nimport './Chat.css';\nimport paperPlaneIcon from '../../../src/img/btn_send_before.png'; // 기본 이미지 경로\nimport paperPlaneHoverIcon from '../../../src/img/btn_send_after.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Chat() {\n  _s();\n  const [stompClient, setStompClient] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [inputValue, setInputValue] = useState('');\n  const [imgSrc, setImgSrc] = useState(paperPlaneIcon);\n  const chatBoxRef = useRef(null);\n  const scrollToBottom = () => {\n    if (chatBoxRef.current) {\n      chatBoxRef.current.scrollTop = chatBoxRef.current.scrollHeight; // 스크롤바를 맨 아래로 내림\n    }\n  };\n\n  useEffect(scrollToBottom, [messages]);\n  useEffect(() => {\n    const socket = new SockJS('https://port-0-spring-boot-sayyo-server-147bpb2mlmecwrp7.sel5.cloudtype.app/ws');\n    const client = new Client({\n      webSocketFactory: () => socket\n    });\n    client.onConnect = function (frame) {\n      client.subscribe('/topic/public', function (chatMessage) {\n        console.log(JSON.parse(chatMessage.body).content);\n        const newMessage = JSON.parse(chatMessage.body).content;\n        setMessages(prevMessages => [...prevMessages, newMessage]);\n      });\n    };\n    client.activate();\n    setStompClient(client);\n    return () => {\n      client.deactivate();\n    };\n  }, []);\n\n  // Send a message\n  const sendMessage = () => {\n    // Send a message if the WebSocket connection is active\n    if (stompClient !== null && stompClient !== void 0 && stompClient.connected) {\n      stompClient.publish({\n        destination: '/app/chat.sendMessage',\n        body: JSON.stringify({\n          content: inputValue\n        })\n      });\n      setInputValue('');\n    }\n  };\n  const handleInputChange = event => {\n    setInputValue(event.target.value);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-messages\",\n      ref: chatBoxRef,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"message-wrapper\",\n        children: messages.map((message, index) => /*#__PURE__*/_jsxDEV(\"p\", {\n          children: message\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 51\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-input\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: inputValue,\n        onChange: handleInputChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: imgSrc,\n        alt: \"send\",\n        onClick: sendMessage,\n        onMouseOver: () => setImgSrc(paperPlaneHoverIcon),\n        onMouseOut: () => setImgSrc(paperPlaneIcon),\n        width: \"30\",\n        height: \"30\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"uv5a6BDOLYzbTE91W/y4A5QvQ1w=\");\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useEffect","useState","useRef","Client","SockJS","paperPlaneIcon","paperPlaneHoverIcon","jsxDEV","_jsxDEV","Chat","_s","stompClient","setStompClient","messages","setMessages","inputValue","setInputValue","imgSrc","setImgSrc","chatBoxRef","scrollToBottom","current","scrollTop","scrollHeight","socket","client","webSocketFactory","onConnect","frame","subscribe","chatMessage","console","log","JSON","parse","body","content","newMessage","prevMessages","activate","deactivate","sendMessage","connected","publish","destination","stringify","handleInputChange","event","target","value","className","children","ref","map","message","index","fileName","_jsxFileName","lineNumber","columnNumber","type","onChange","src","alt","onClick","onMouseOver","onMouseOut","width","height","_c","$RefreshReg$"],"sources":["C:/Users/user/Desktop/Sayo_/sayyo/src/views/Chat/index.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport { Client } from '@stomp/stompjs';\r\nimport SockJS from 'sockjs-client';\r\nimport './Chat.css';\r\nimport paperPlaneIcon from '../../../src/img/btn_send_before.png'; // 기본 이미지 경로\r\nimport paperPlaneHoverIcon from '../../../src/img/btn_send_after.png';\r\nexport default  function Chat() {\r\n    const [stompClient, setStompClient] = useState(null);\r\n    const [messages, setMessages] = useState([]);\r\n    const [inputValue, setInputValue] = useState('');\r\n    const [imgSrc, setImgSrc] = useState(paperPlaneIcon);\r\n\r\n    const chatBoxRef = useRef(null);\r\n    const scrollToBottom = () => {\r\n        if (chatBoxRef.current) {\r\n            chatBoxRef.current.scrollTop = chatBoxRef.current.scrollHeight; // 스크롤바를 맨 아래로 내림\r\n        }\r\n    };\r\n\r\n    useEffect(scrollToBottom, [messages]);\r\n    useEffect(() => {\r\n        const socket = new SockJS('https://port-0-spring-boot-sayyo-server-147bpb2mlmecwrp7.sel5.cloudtype.app/ws');\r\n        const client = new Client({\r\n            webSocketFactory: () => socket,\r\n        });\r\n\r\n        client.onConnect = function (frame) {\r\n            client.subscribe('/topic/public', function (chatMessage) {\r\n                console.log(JSON.parse(chatMessage.body).content);\r\n                const newMessage = JSON.parse(chatMessage.body).content;\r\n\r\n                setMessages(prevMessages => [...prevMessages, newMessage]);\r\n\r\n            });\r\n        };\r\n        client.activate();\r\n        setStompClient(client);\r\n\r\n        return () => {\r\n            client.deactivate();\r\n        };\r\n    }, []);\r\n\r\n    // Send a message\r\n    const sendMessage = () => {\r\n        // Send a message if the WebSocket connection is active\r\n        if (stompClient?.connected) {\r\n            stompClient.publish({\r\n                destination: '/app/chat.sendMessage',\r\n                body: JSON.stringify({ content: inputValue })\r\n            });\r\n            setInputValue('');\r\n        }\r\n    };\r\n\r\n    const handleInputChange = (event) => {\r\n        setInputValue(event.target.value);\r\n    };\r\n\r\n    return (\r\n    <div className=\"chat-container\">\r\n        <div className=\"chat-messages\" ref={chatBoxRef}>\r\n            <div className=\"message-wrapper\">\r\n                {messages.map((message, index) => <p key={index}>{message}</p>)}\r\n            </div>\r\n        </div>\r\n        <div className=\"chat-input\">\r\n            <input type=\"text\" value={inputValue} onChange={handleInputChange} />\r\n            <img \r\n                    src={imgSrc} \r\n                    alt=\"send\" \r\n                    onClick={sendMessage} \r\n                    onMouseOver={() => setImgSrc(paperPlaneHoverIcon)}\r\n                    onMouseOut={() => setImgSrc(paperPlaneIcon)}\r\n                    width=\"30\" \r\n                    height=\"30\"\r\n                />\r\n        </div>\r\n    </div>\r\n);\r\n    \r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}